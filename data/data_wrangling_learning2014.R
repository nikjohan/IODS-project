
#Week 2 Niko Johansson 11/11/2019 Data wrangling for linear regression.



#opening the data and creating the data frame
learning2014 <-read.table("http://www.helsinki.fi/~kvehkala/JYTmooc/JYTOPKYS3-data.txt", sep = "\t", header = T)


#dimensions of the data frame
dim(learning2014)
#output:
#[1] 183  60
#60 variables, 183 observations.

#structure of the data frame
str(learning2014)
#output:
# 'data.frame':	183 obs. of  60 variables:
#   $ Aa      : int  3 2 4 4 3 4 4 3 2 3 ...
# $ Ab      : int  1 2 1 2 2 2 1 1 1 2 ...
# $ Ac      : int  2 2 1 3 2 1 2 2 2 1 ...
# $ Ad      : int  1 2 1 2 1 1 2 1 1 1 ...
# $ Ae      : int  1 1 1 1 2 1 1 1 1 1 ...
# $ Af      : int  1 1 1 1 1 1 1 1 1 2 ...
# $ ST01    : int  4 4 3 3 4 4 5 4 4 4 ...
# $ SU02    : int  2 2 1 3 2 3 2 2 1 2 ...
# $ D03     : int  4 4 4 4 5 5 4 4 5 4 ...
# $ ST04    : int  4 4 4 4 3 4 2 5 5 4 ...
# $ SU05    : int  2 4 2 3 4 3 2 4 2 4 ...
# $ D06     : int  4 2 3 4 4 5 3 3 4 4 ...
# $ D07     : int  4 3 4 4 4 5 4 4 5 4 ...
# $ SU08    : int  3 4 1 2 3 4 4 2 4 2 ...
# $ ST09    : int  3 4 3 3 4 4 2 4 4 4 ...
# $ SU10    : int  2 1 1 1 2 1 1 2 1 2 ...
# $ D11     : int  3 4 4 3 4 5 5 3 4 4 ...
# $ ST12    : int  3 1 4 3 2 3 2 4 4 4 ...
# $ SU13    : int  3 3 2 2 3 1 1 2 1 2 ...
# $ D14     : int  4 2 4 4 4 5 5 4 4 4 ...
# $ D15     : int  3 3 2 3 3 4 2 2 3 4 ...
# $ SU16    : int  2 4 3 2 3 2 3 3 4 4 ...
# $ ST17    : int  3 4 3 3 4 3 4 3 4 4 ...
# $ SU18    : int  2 2 1 1 1 2 1 2 1 2 ...
# $ D19     : int  4 3 4 3 4 4 4 4 5 4 ...
# $ ST20    : int  2 1 3 3 3 3 1 4 4 2 ...
# $ SU21    : int  3 2 2 3 2 4 1 3 2 4 ...
# $ D22     : int  3 2 4 3 3 5 4 2 4 4 ...
# $ D23     : int  2 3 3 3 3 4 3 2 4 4 ...
# $ SU24    : int  2 4 3 2 4 2 2 4 2 4 ...
# $ ST25    : int  4 2 4 3 4 4 1 4 4 4 ...
# $ SU26    : int  4 4 4 2 3 2 1 4 4 4 ...
# $ D27     : int  4 2 3 3 3 5 4 4 5 4 ...
# $ ST28    : int  4 2 5 3 5 4 1 4 5 2 ...
# $ SU29    : int  3 3 2 3 3 2 1 2 1 2 ...
# $ D30     : int  4 3 4 4 3 5 4 3 4 4 ...
# $ D31     : int  4 4 3 4 4 5 4 4 5 4 ...
# $ SU32    : int  3 5 5 3 4 3 4 4 3 4 ...
# $ Ca      : int  2 4 3 3 2 3 4 2 3 2 ...
# $ Cb      : int  4 4 5 4 4 5 5 4 5 4 ...
# $ Cc      : int  3 4 4 4 4 4 4 4 4 4 ...
# $ Cd      : int  4 5 4 4 3 4 4 5 5 5 ...
# $ Ce      : int  3 5 3 3 3 3 4 3 3 4 ...
# $ Cf      : int  2 3 4 4 3 4 5 3 3 4 ...
# $ Cg      : int  3 2 4 4 4 5 5 3 5 4 ...
# $ Ch      : int  4 4 2 3 4 4 3 3 5 4 ...
# $ Da      : int  3 4 1 2 3 3 2 2 4 1 ...
# $ Db      : int  4 3 4 4 4 5 4 4 2 4 ...
# $ Dc      : int  4 3 4 5 4 4 4 4 4 4 ...
# $ Dd      : int  5 4 1 2 4 4 5 3 5 2 ...
# $ De      : int  4 3 4 5 4 4 5 4 4 2 ...
# $ Df      : int  2 2 1 1 2 3 1 1 4 1 ...
# $ Dg      : int  4 3 3 5 5 4 4 4 5 1 ...
# $ Dh      : int  3 3 1 4 5 3 4 1 4 1 ...
# $ Di      : int  4 2 1 2 3 3 2 1 4 1 ...
# $ Dj      : int  4 4 5 5 3 5 4 5 2 4 ...
# $ Age     : int  53 55 49 53 49 38 50 37 37 42 ...
# $ Attitude: int  37 31 25 35 37 38 35 29 38 21 ...
# $ Points  : int  25 12 24 10 22 21 21 31 24 26 ...
# $ gender  : Factor w/ 2 levels "F","M": 1 2 1 2 2 1 2 1 2 1 ...
#variables Aa to Dj individual question scores on the 1-5 Likert scale. Then Age, Attitude score and total exam score Points as numerical values. Finally gender, categorical variable with 1 = F (female) and 2 = M (male).


library(dplyr)

#combining variables
deep_questions <- c("D03", "D11", "D19", "D27", "D07", "D14", "D22", "D30","D06",  "D15", "D23", "D31")
surface_questions <- c("SU02","SU10","SU18","SU26", "SU05","SU13","SU21","SU29","SU08","SU16","SU24","SU32")
strategic_questions <- c("ST01","ST09","ST17","ST25","ST04","ST12","ST20","ST28")
deep_columns <- select(learning2014, one_of(deep_questions))
learning2014$deep <- rowMeans(deep_columns)
surface_columns <- select(learning2014, one_of(surface_questions))
learning2014$surf <- rowMeans(surface_columns)
strategic_columns <- select(learning2014, one_of(strategic_questions))
learning2014$stra <- rowMeans(strategic_columns)

#narrowing down the data frame
keep_columns <- c("Age", "Attitude", "gender", "Points", "deep", "stra", "surf")
learning2014analysis <- select(learning2014, one_of(keep_columns))
learning2014analysis[learning2014analysis$Points == 0,]
#excluding exam score = o
learning2014analysis <- filter(learning2014analysis, learning2014analysis$Points > 0)

#structure of the new dataset
str(learning2014analysis)

#rename columns so that no capital letters
colnames(learning2014analysis)
colnames(learning2014analysis)[1] <- "age"
colnames(learning2014analysis)[2] <- "attitude"
colnames(learning2014analysis)[4] <- "points"
colnames(learning2014analysis)

str(learning2014analysis)

#setting the working directory
setwd("C:\\Users\\Niko\\Documents\\IODS-project\\data")

#saving the data
write.csv(learning2014analysis, "learning2014analysis.csv", row.names = F)

#and finally to prove this works
test <- read.csv("learning2014analysis.csv", header = T)
str(test)
head(test)

install.packages("GGally")
p <- ggpairs(learning2014analysis, mapping = aes(col = gender), lower = list(combo = wrap("facethist", bins = 20)))
p
install.packages("progress")
library(GGally)
library(ggplot2)

